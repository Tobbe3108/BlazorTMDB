@using BlazorTMDB.Shared.Models
@using Microsoft.AspNetCore.SignalR.Client
@inject NavigationManager NavigationManager

<div id="searchContainer">
    <p>@_response</p>
    <button @onclick="Send">Search</button>
</div>
<hr />

@code {
    private HubConnection _hubConnection;
    private string _response = "Nothing";

    protected override async Task OnInitializedAsync()
    {
        _hubConnection = new HubConnectionBuilder()
            .WithUrl(NavigationManager.ToAbsoluteUri("/chatHub"))
            .Build();

        _hubConnection.On<string>
    ("ReceiveMessage", response =>
    {
        _response = response;
        StateHasChanged();
    });

        await _hubConnection.StartAsync();
    }

    Task Send() =>
    _hubConnection.SendAsync("SendMessage");

    public bool IsConnected =>
    _hubConnection.State == HubConnectionState.Connected;
}